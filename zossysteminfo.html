<!DOCTYPE html>
<html ng-app="">
<head>
<link rel="stylesheet" href = "http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="//cdn.datatables.net/plug-ins/3cfcc339e89/integration/bootstrap/3/dataTables.bootstrap.css">
<link rel="stylesheet" href="./css/main.css">
<script type="text/javascript" language="javascript" src="//cdn.datatables.net/plug-ins/3cfcc339e89/integration/bootstrap/3/dataTables.bootstrap.js"></script>
<script src= "http://ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular.min.js"></script><!--Angular-->
<script src= "https://code.jquery.com/jquery-1.11.3.min.js"></script><!--Jquery-->
<script type="text/javascript">
 <!--
     function toggle_visibility(id) {
        var e = document.getElementById(id);
        if(e.style.display == 'block')
           e.style.display = 'none';
        else
           e.style.display = 'block';
     }
 //-->
</script>

</head>

<body ng-controller="systemsController">
<!--All the popup boxes-->                                                                                                      
<link rel="import" href="./resources/popup.html">

<div class="container">
<h3>&nbsp;&nbsp;z/OS Systems (at 8200 Warden)</h3> <table border=0 width=100%><tr><td align=right><a href="http://toronetx.torolab.ibm.com/www/index.html">Home</a></td></tr></table>

<p style="padding-left:20px">Search: <input ng-model="searchText"></p>
<table class="table table-striped table-hover table-condensed table-bordered">
  <thead>
    <tr style="background-color:lightblue;">
     <!-- HEADER CELLS START -->
     <th nowrap>HOSTNAME</th>
     <th nowrap>STATUS</th>
     <th nowrap>IMAGE TYPE</th>
     <th nowrap>LPAR NAME</th>
     <th nowrap>PROCESSOR NAME</th>
     <th nowrap>Z/OS VERSION</th>
     <th nowrap>NETWORK DETAILS</th>
     <th nowrap>IPL ADDRESS</th>
     <th nowrap>IPL VOLUME</th>
     <th nowrap>IPL LOAD PARMS</th>
     <th nowrap>LAST IPL DATE</th>
     <th nowrap>CURRENT IODF</th>
     <th nowrap>CPU MODEL</th>
     <th nowrap>CPU SERIAL</th>
     <th>CPUs ONLINE</th>
     <th>TOTAL CPUs</th>
     <th>REAL STORAGE</th>
     <th nowrap><a style="color : black;" href="javascript:void(0)" onclick="toggle_visibility('MIPS');">MIPS*</a></th>
<!-- <th nowrap>CPC DETAILS</th> -->
<!-- <th nowrap>AS-AT</th> -->
     <th nowrap><a style="color : black;" href="javascript:void(0)" onclick="toggle_visibility('CUSTODIANS');">Primary User</a></th>
     <th>Date this info updated</th>
     <!-- HEADER CELLS END   -->
    </tr>
  </thead>
  <tbody>
    <tr ng-repeat="system in systems | filter:searchText">
      <td ng-bind-html="renderHtml(system.HOSTNAME)"></td>
      <td ng-bind-html="renderHtml(system.STATUS)"></td>
      <td ng-bind-html="renderHtml(system.IMGTYPE)"></td>
      <td ng-bind-html="renderHtml(system.LPAR_NAME)"></td>
      <td ng-bind-html="renderHtml(system.HWNAME)"></td>
      <td ng-bind-html="renderHtml(system.OS_VERSION)"></td>
      <td ng-bind-html="renderHtml(system.IPADDRESS)"></td>
      <td ng-bind-html="renderHtml(system.IPLADDR)"></td>
      <td ng-bind-html="renderHtml(system.IPLVOL)"></td>
      <td ng-bind-html="renderHtml(system.IPLLOAD)"></td>
      <td ng-bind-html="renderHtml(system.IPLDATE)"></td>
      <td ng-bind-html="renderHtml(system.CURRENT_IODF)"></td>
      <td ng-bind-html="renderHtml(system.CPUMODEL)"></td>
      <td ng-bind-html="renderHtml(system.CPUSERIAL)"></td>
      <td ng-bind-html="renderHtml(system.ONLCPU)"></td>
      <td ng-bind-html="renderHtml(system.TOTCPU)"></td>
      <td ng-bind-html="renderHtml(system.REALSTOR)"></td>
      <td ng-bind-html="renderHtml(system.MIPS)"></td>
<!--  <td ng-bind-html="renderHtml(system.CPCDETAIL)"></td> -->
<!--  <td nowrap ng-bind-html="renderHtml(system.AS_AT)"></td> -->
      <td nowrap ng-bind-html="renderHtml(system.CUSTODIAN_DETAIL)"></td>
      <td nowrap ng-bind-html="renderHtml(system.UPDATE)"></td>
    </tr>
  </tbody>
</table>

<hr>
<hr>

<!--
Ok, nicely awkward bit of processing here.  Although the HTML file can be in EBCDIC
the input file (.json) has to be in ASCII.  So we have to make sure that once the
file has been successfully created by this system,  it is passed through an
iconv command to convert everything.
if you are on a z/OS machine,  you'll notice that the .json file is binary.
so effectively, we need a source and binary set of files for this application
-->
<script>

 function systemsController($scope,$http,$sce) {
 $http.get("converted.json")
 .success(function(response) {$scope.systems = response;});
  $scope.renderHtml = function(html_code)
 {
     return $sce.trustAsHtml(html_code);
 };
 }
 </script>
</body>
</html>
